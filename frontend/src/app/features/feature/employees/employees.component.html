<section class="main">
    <app-sidebar/>
    <section class="employees">
        <!-- Header Minimalista -->
        <div class="employees-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="icon-wrapper">
                        <img src="../../../../assets/person.svg" alt="Colaboradores" class="header-icon">
                    </div>
                    <div class="title-group">
                        <h1>COLABORADORES</h1>
                        <p class="subtitle">{{ totalEmployees }} colaboradores • {{ totalHours }}h trabalhadas • {{ avgEfficiency }}% eficiência</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controles Minimalistas -->
        <div class="controls-section">
            <div class="search-wrapper">
                <app-barra-pesquisa placeholder="Buscar colaborador..."/>
            </div>
            
            <div class="filter-wrapper">
                <img src="../../../../assets/table.svg" alt="Filtro" class="filter-icon">
                <select class="filter-select" [(ngModel)]="filterBy" (change)="applyFilter()">
                    <option value="all">Todos os Colaboradores</option>
                    <option value="active">Apenas Ativos</option>
                    <option value="high-performance">Alta Performance (≥90%)</option>
                    <option value="needs-attention">Requer Atenção (&lt;70%)</option>
                </select>
            </div>
        </div>
        
        <!-- Grid de colaboradores -->
        <div class="cards-conteiner">
            <div class="employee-card" *ngFor="let employee of filteredEmployees" 
                 [class.high-performance]="employee.efficiency >= 90"
                 [class.needs-attention]="employee.efficiency < 70"
                 (mousemove)="onCardMouseMove($event, cardEl)"
                 (mouseleave)="onCardMouseLeave(cardEl)"
                 #cardEl>
                
                <!-- Header do card -->
                <div class="card-header">
                    <div class="avatar-section">
                        <div class="avatar-wrapper">
                            <img [src]="employee.avatarUrl" [alt]="employee.nome" class="avatar">
                            <div class="status-indicator" [class.online]="employee.isActive"></div>
                        </div>
                        <div class="employee-info">
                            <h3 class="employee-name">{{ employee.nome }}</h3>
                            <p class="employee-role">{{ employee.cargo }}</p>
                            <div class="employee-tags">
                                <span class="tag" *ngFor="let tag of employee.tags">{{ tag }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="view-details-btn" (click)="viewDetails(employee)">
                        <img src="../../../../assets/busca_icon.svg" alt="Detalhes" class="btn-icon">
                    </button>
                </div>

                <!-- Métricas principais -->
                <div class="card-metrics">
                    <div class="metric-item">
                        <div class="metric-icon-wrapper primary">
                            <img src="../../../../assets/clock.svg" alt="Horas" class="metric-icon">
                        </div>
                        <div class="metric-content">
                            <span class="metric-value">{{ employee.totalHours }}h</span>
                            <span class="metric-label">Horas Mês</span>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-icon-wrapper secondary1">
                            <img src="../../../../assets/table.svg" alt="Issues" class="metric-icon">
                        </div>
                        <div class="metric-content">
                            <span class="metric-value">{{ employee.totalIssues }}</span>
                            <span class="metric-label">Issues</span>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-icon-wrapper secondary2">
                            <img src="../../../../assets/check.svg" alt="Concluídas" class="metric-icon">
                        </div>
                        <div class="metric-content">
                            <span class="metric-value">{{ employee.completedIssues }}</span>
                            <span class="metric-label">Concluídas</span>
                        </div>
                    </div>
                </div>

                <!-- Informações de Produtividade -->
                <div class="productivity-section">
                    <div class="productivity-info">
                        <span class="productivity-label">Produtividade do Mês</span>
                        <div class="productivity-stats">
                            <div class="stat-item">
                                <img src="../../../../assets/check.svg" alt="Concluídas" class="stat-icon">
                                <span class="stat-value">{{ employee.completedIssues }} concluídas</span>
                            </div>
                            <div class="stat-item">
                                <img src="../../../../assets/clock.svg" alt="Horas" class="stat-icon">
                                <span class="stat-value">{{ employee.totalHours }}h trabalhadas</span>
                            </div>
                        </div>
                    </div>
                    <div class="productivity-badge">
                        {{ employee.efficiency }}% Performance
                    </div>
                </div>

                <!-- Gráfico de atividade recente -->
                <div class="activity-chart">
                    <div class="chart-header">
                        <span class="chart-title">Atividade Semanal</span>
                    </div>
                    <div class="mini-chart">
                        <div class="chart-bar" *ngFor="let activity of employee.weeklyActivity; let i = index"
                             [style.height.%]="(activity / getMaxActivity(employee.weeklyActivity)) * 100"
                             [class.active]="i === getCurrentDayIndex()">
                            <span class="bar-value">{{ activity }}</span>
                        </div>
                    </div>
                </div>

                <!-- Status e projetos -->
                <div class="card-footer">
                    <div class="projects-section">
                        <span class="projects-label">Projetos:</span>
                        <div class="projects-tags">
                            <span class="project-tag" *ngFor="let project of employee.projects">
                                {{ project }}
                            </span>
                        </div>
                    </div>
                    
                    <div class="status-badges">
                        <span class="badge success" *ngIf="employee.onTimeDeliveries > 0">
                            ✓ {{ employee.onTimeDeliveries }} no prazo
                        </span>
                        <span class="badge warning" *ngIf="employee.lateDeliveries > 0">
                            ⚠ {{ employee.lateDeliveries }} atrasadas
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty state -->
        <div class="empty-state" *ngIf="filteredEmployees.length === 0">
            <img src="../../../../assets/busca_icon.svg" alt="Sem resultados" class="empty-icon">
            <h3>Nenhum colaborador encontrado</h3>
            <p>Tente ajustar os filtros ou a busca</p>
        </div>
    </section>
</section>